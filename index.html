<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Calculadora de Comissão</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { max-width: 400px; margin: auto; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input { width: 100%; padding: 8px; margin-top: 4px; }
        button { margin-top: 15px; padding: 10px; width: 100%; background: #28a745; color: white; border: none; cursor: pointer; }
        button:hover { background: #218838; }
        .resultado { margin-top: 20px; padding: 15px; background: #f1f1f1; border-radius: 5px; }
    </style>
</head>
<body>

<h1>Calculadora de Comissão</h1>

<!-- Etapa 1 -->
<form id="calcForm1">
    <label>Valor da Parcela</label>
    <input type="text" id="parcela" required placeholder="Ex: 1.157,55">

    <label>Saldo Devedor</label>
    <input type="text" id="saldodevedor" required placeholder="Ex: 20.000,00">

    <label>Valor a Descontar</label>
    <input type="text" id="desconto" required placeholder="Ex: 1.000,00">

    <button type="submit">Calcular Valor Geral</button>
</form>

<!-- Resultado da primeira parte -->
<div class="resultado" id="resultadoParcial" style="display:none;"></div>

<!-- Etapa 2 -->
<form id="calcForm2" style="display:none;">
    <label>Comissão Final do Escritório</label>
    <input type="text" id="comissaoesc" required placeholder="Ex: 500,00">
    <button type="submit">Calcular Oferta</button>
</form>

<!-- Resultado final -->
<div class="resultado" id="resultadoFinal" style="display:none;"></div>

<script>
    function moedaParaFloat(valor) {
        valor = valor.replace(/\./g, "").replace(",", ".");
        return parseFloat(valor) || 0;
    }

    function formatarMoeda(valor) {
        return valor.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
    }

    let valorGeral = 0, parcela = 0, investidor = 0;

    // Primeira parte do cálculo
    document.getElementById("calcForm1").addEventListener("submit", function(e) {
        e.preventDefault();

        parcela = moedaParaFloat(document.getElementById("parcela").value);
        let saldoDevedor = moedaParaFloat(document.getElementById("saldodevedor").value);
        let desconto = moedaParaFloat(document.getElementById("desconto").value);

        let novoSaldo = parcela / 0.02;
        let saldoSubtracao = novoSaldo - saldoDevedor - desconto;
        investidor = saldoDevedor * 0.10;
        let gerente = saldoSubtracao * 0.15;
        valorGeral = saldoSubtracao - investidor - gerente;

        document.getElementById("resultadoParcial").style.display = "block";
        document.getElementById("resultadoParcial").innerHTML = `
            <h2>Resultado Parcial</h2>
            <p><strong>Valor da Parcela:</strong> ${formatarMoeda(parcela)}</p>
            <p><strong>Comissão do Investidor:</strong> ${formatarMoeda(investidor)}</p>
            <p><strong>Valor Geral Líquido:</strong> ${formatarMoeda(valorGeral)}</p>
        `;

        // Mostra o segundo formulário
        document.getElementById("calcForm2").style.display = "block";
    });

    // Segunda parte do cálculo
    document.getElementById("calcForm2").addEventListener("submit", function(e) {
        e.preventDefault();

        let comissaoEsc = moedaParaFloat(document.getElementById("comissaoesc").value);
        let oferta = valorGeral - comissaoEsc;

        document.getElementById("resultadoFinal").style.display = "block";
        document.getElementById("resultadoFinal").innerHTML = `
            <h2>Resultado Final</h2>
            <p><strong>Comissão do Escritório:</strong> ${formatarMoeda(comissaoEsc)}</p>
            <p><strong>Valor para Oferecer ao Cliente:</strong> ${formatarMoeda(oferta)}</p>
        `;
    });
</script>

</body>
</html>
